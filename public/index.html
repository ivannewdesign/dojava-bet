<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dojava.bet 
    - U≈æivo Sportski Rezultati</title>
  
  <!-- Flag Icons CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@7.2.3/css/flag-icons.min.css"/>
  
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
      background: #f5f7fa;
      color: #2d3748;
      line-height: 1.6;
    }
    
    /* HEADER */
    .header {
      background: #ffffff;
      padding: 20px 0;
      border-bottom: 1px solid #e2e8f0;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .header-content {
      max-width: 1400px;
      margin: 0 auto;
      padding: 0 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .logo {
      font-size: 28px;
      font-weight: 800;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-decoration: none;
    }
    
    .nav {
      display: flex;
      gap: 30px;
    }
    
    .nav a {
      color: #4a5568;
      text-decoration: none;
      font-weight: 600;
      transition: color 0.3s;
    }
    
    .nav a:hover {
      color: #667eea;
    }

    /* FLAG ICONS */
.fi {
  width: 20px;
  height: 15px;
  display: inline-block;
  margin-right: 8px;
  border-radius: 2px;
  box-shadow: 0 1px 2px rgba(0,0,0,0.1);
}

     /* BETA BANNER */
.beta-banner {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 12px 20px;
  display: flex;
  align-items: center;
  gap: 15px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
  position: relative;
}

.beta-icon {
  font-size: 24px;
}

.beta-banner p {
  margin: 0;
  font-size: 14px;
  flex: 1;
}

.beta-banner strong {
  font-weight: 700;
  margin-right: 8px;
}

.beta-close {
  background: rgba(255,255,255,0.2);
  border: none;
  color: white;
  font-size: 18px;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  cursor: pointer;
  transition: background 0.3s;
}

.beta-close:hover {
  background: rgba(255,255,255,0.3);
}
    
    /* SPORT TABS - STICKY */
    .sport-tabs {
      background: #ffffff;
      padding: 15px 20px;
      display: flex;
      gap: 10px;
      justify-content: center;
      border-bottom: 1px solid #e2e8f0;
      position: sticky;
      top: 0;
      z-index: 99;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    
    .sport-tab {
      padding: 10px 25px;
      background: #f7fafc;
      border: 2px solid #e2e8f0;
      border-radius: 10px;
      cursor: pointer;
      font-size: 15px;
      font-weight: 600;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 8px;
      color: #4a5568;
    }
    
    .sport-tab:hover {
      border-color: #cbd5e0;
      background: #edf2f7;
    }
    
    .sport-tab.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      border-color: #667eea;
      color: #ffffff;
    }
    
    /* MAIN LAYOUT */
    .main-layout {
      display: flex;
      max-width: 1400px;
      margin: 20px auto;
      gap: 20px;
      padding: 0 20px;
    }
    
    /* SIDEBAR */
    .sidebar {
      width: 280px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      overflow: hidden;
      position: sticky;
      top: 100px;
      height: fit-content;
      max-height: calc(100vh - 120px);
      overflow-y: auto;
    }
    
    .sidebar-section {
      border-bottom: 1px solid #f0f4f8;
    }
    
    .sidebar-title {
      font-size: 11px;
      font-weight: 700;
      color: #a0aec0;
      text-transform: uppercase;
      padding: 15px 20px 10px;
      letter-spacing: 1px;
      background: #f7fafc;
    }
    
    .category-header {
      padding: 8px 20px;
      font-size: 12px;
      font-weight: 700;
      color: #667eea;
      text-transform: uppercase;
      background: #f7fafc;
    }
    
    /* PINNED LEAGUES */
    .pinned-league {
      padding: 10px 20px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
      color: #2d3748;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .pinned-league:hover {
      background: #f7fafc;
    }
    
    .pinned-league.active {
      background: #edf2f7;
      color: #667eea;
      font-weight: 600;
    }
    
    .league-flag {
      font-size: 18px;
      min-width: 22px;
      display: inline-flex;
      align-items: center;
    }
    
    .flag-icon {
      width: 22px;
      height: 16px;
      border-radius: 2px;
      display: inline-block;
      background-size: contain;
      background-position: center;
      background-repeat: no-repeat;
    }
    
    .pin-icon {
      margin-left: auto;
      cursor: pointer;
      opacity: 0.4;
      font-size: 12px;
      transition: opacity 0.2s;
    }
    
    .pin-icon:hover {
      opacity: 1;
    }
    
    /* COLLAPSIBLE SECTION */
    .collapsible-header {
      padding: 12px 20px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 600;
      color: #4a5568;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
      background: #fafbfc;
    }
    
    .collapsible-header:hover {
      background: #f0f4f8;
    }
    
    .collapsible-arrow {
      margin-left: auto;
      transition: transform 0.3s;
      font-size: 12px;
      color: #a0aec0;
    }
    
    .collapsible-section.expanded .collapsible-arrow {
      transform: rotate(180deg);
    }
    
    .collapsible-content {
      display: none;
      background: #fafbfc;
    }
    
    .collapsible-section.expanded .collapsible-content {
      display: block;
    }
    
    /* COUNTRIES */
    .country-item {
      border-bottom: 1px solid #f0f4f8;
    }
    
    .country-header {
      padding: 12px 20px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: #4a5568;
      display: flex;
      align-items: center;
      gap: 10px;
      transition: all 0.2s;
    }
    
    .country-header:hover {
      background: #f7fafc;
    }
    
    .country-arrow {
      margin-left: auto;
      transition: transform 0.3s;
      font-size: 12px;
      color: #a0aec0;
    }
    
    .country-item.expanded .country-arrow {
      transform: rotate(180deg);
    }
    
    .country-leagues {
      display: none;
      background: #fafbfc;
      padding: 5px 0;
    }
    
    .country-item.expanded .country-leagues {
      display: block;
    }
    
    .country-league {
      padding: 8px 20px 8px 50px;
      cursor: pointer;
      font-size: 13px;
      color: #718096;
      display: flex;
      align-items: center;
      gap: 8px;
      transition: all 0.2s;
    }
    
    .country-league:hover {
      background: #f0f4f8;
      color: #2d3748;
    }
    
    .country-league.pinned {
      color: #667eea;
      font-weight: 600;
    }
    
    .country-league.selected {
      background: #edf2f7;
      color: #667eea;
      font-weight: 600;
    }
    
    .show-more-btn {
      padding: 15px 20px;
      text-align: center;
      cursor: pointer;
      font-size: 13px;
      color: #667eea;
      font-weight: 600;
      transition: all 0.2s;
    }
    
    .show-more-btn:hover {
      background: #f7fafc;
    }
    
    /* CONTENT */
    .content {
      flex: 1;
      max-width: 800px;
    }
    
    /* AD SPACE */
    .ad-space {
      width: 300px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      padding: 20px;
      text-align: center;
      color: #a0aec0;
      font-size: 14px;
      position: sticky;
      top: 100px;
      height: fit-content;
    }
    
    .ad-placeholder {
      border: 2px dashed #e2e8f0;
      border-radius: 8px;
      padding: 80px 20px;
      margin-bottom: 20px;
    }
    
    /* LEAGUE SECTION - MINIMALNI SPACING */
    .league-section {
      margin-bottom: 15px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
      overflow: hidden;
    }
    
    .league-header {
      background: linear-gradient(135deg, #f7fafc 0%, #edf2f7 100%);
      padding: 8px 20px;
      font-weight: 700;
      font-size: 13px;
      color: #2d3748;
      border-left: 4px solid #667eea;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .league-country {
      color: #a0aec0;
      font-size: 11px;
      font-weight: 600;
    }
    
    /* MATCH CARD - MINIMALNI PADDING */
    .match-card {
      padding: 6px 20px;
      border-bottom: 1px solid #f0f4f8;
      transition: all 0.2s;
      cursor: pointer;
    }
    
    .match-card:last-child {
      border-bottom: none;
    }
    
    .match-card:hover {
      background: #f7fafc;
    }
    
    .match-header {
      display: flex;
      justify-content: flex-end;
      margin-bottom: 4px;
    }
    
    .match-time {
      background: #667eea;
      color: white;
      padding: 2px 8px;
      border-radius: 5px;
      font-size: 10px;
      font-weight: 700;
    }
    
    .match-time.live {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.8; }
    }
    
    .match-teams {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
    }
    
    .team {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .team-logo {
      width: 20px;
      height: 20px;
      object-fit: contain;
    }
    
    .team-name {
      font-size: 13px;
      font-weight: 600;
      color: #2d3748;
      flex: 1;
    }
    
    .team-score {
      font-size: 16px;
      font-weight: 800;
      color: #667eea;
      min-width: 22px;
      text-align: center;
    }
    
    .match-vs {
      padding: 0 10px;
      font-size: 14px;
      font-weight: 700;
      color: #cbd5e0;
    }
    
    .team-right {
      flex-direction: row-reverse;
    }
    
    /* LOADING */
    .loading {
      text-align: center;
      padding: 60px;
      font-size: 16px;
      color: #a0aec0;
    }
    
    .spinner {
      border: 3px solid rgba(102, 126, 234, 0.2);
      border-top: 3px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* NO MATCHES */
    .no-matches {
      text-align: center;
      padding: 80px 20px;
      color: #a0aec0;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .no-matches h2 {
      color: #4a5568;
      margin-bottom: 10px;
    }
    
    /* SCROLLBAR */
    .sidebar::-webkit-scrollbar {
      width: 6px;
    }
    
    .sidebar::-webkit-scrollbar-track {
      background: #f7fafc;
    }
    
    .sidebar::-webkit-scrollbar-thumb {
      background: #cbd5e0;
      border-radius: 3px;
    }
    
    .sidebar::-webkit-scrollbar-thumb:hover {
      background: #a0aec0;
    }
    
    /* RESPONSIVE */
    @media (max-width: 1200px) {
      .ad-space {
        display: none;
      }
    }
    
    @media (max-width: 1024px) {
      .sidebar {
        display: none;
      }
      
      .content {
        max-width: 100%;
      }
    }
  </style>
</head>
<body>

  <!-- HEADER -->
  <header class="header">
    <div class="header-content">
      <a href="/" class="logo">DOJAVA.BET</a>
      <nav class="nav">
        <a href="#live">U≈æivo</a>
        <a href="#leagues">Lige</a>
        <a href="#premium">Premium</a>
      </nav>
    </div>
  </header>

  </header>

<!-- BETA BANNER -->
<div class="beta-banner">
  <span class="beta-icon">üöß</span>
  <p>
    <strong>Stranica u izgradnji!</strong> 
    Gre≈°ke i bugovi su oƒçekivani. Pratite nas! Jer uskoro lansiramo alat koji kladionice neƒáe voljeti ! üöÄ
  </p>
  <button class="beta-close" onclick="this.parentElement.style.display='none'">‚úï</button>
</div>

<!-- SPORT TABS - STICKY -->

  
  <!-- SPORT TABS - STICKY -->
  <div class="sport-tabs">
    <div class="sport-tab active" data-sport="football">
      <span>‚öΩ</span> Nogomet
    </div>
    <div class="sport-tab" data-sport="basketball">
      <span>üèÄ</span> Ko≈°arka
    </div>
    <div class="sport-tab" data-sport="tennis">
      <span>üéæ</span> Tenis
    </div>
  </div>

  <!-- MAIN LAYOUT -->
  <div class="main-layout">
    
    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="loading">
        <div class="spinner"></div>
        Uƒçitavanje...
      </div>
    </aside>

    <!-- CONTENT -->
    <main class="content" id="content">
      <div class="loading">
        <div class="spinner"></div>
        Uƒçitavanje utakmica...
      </div>
    </main>

    <!-- AD SPACE -->
    <aside class="ad-space">
      <div class="ad-placeholder">
        <div style="font-size: 48px; margin-bottom: 10px;">üìä</div>
        <div>Prostor za Reklamu</div>
        <div style="font-size: 11px; margin-top: 5px;">300 x 600</div>
      </div>
      <div class="ad-placeholder" style="padding: 40px 20px;">
        <div style="font-size: 36px; margin-bottom: 10px;">üìà</div>
        <div>Google AdSense</div>
        <div style="font-size: 11px; margin-top: 5px;">300 x 250</div>
      </div>
    </aside>

  </div>

  <script>
    // ==================== STATE ====================
    let allMatches = {
      football: [],
      basketball: [],
      tennis: []
    };
    
    let currentSport = 'football';
    let selectedLeague = null;
    
    let pinnedLeaguesBySport = JSON.parse(localStorage.getItem('pinnedLeaguesBySport')) || {
      football: getDefaultPinnedLeagues('football'),
      basketball: getDefaultPinnedLeagues('basketball'),
      tennis: getDefaultPinnedLeagues('tennis')
    };
    
    let expandedCountries = {};
    let expandedInternational = false;
    let countryLeagues = {};
    let showAllCountries = false;
    let allCountriesData = [];
    
    // ==================== DEFAULT PINNED LEAGUES BY SPORT ====================
    function getDefaultPinnedLeagues(sport) {
      if (sport === 'football') {
        return [
          { name: 'UEFA Champions League', flag: 'üèÜ' },
          { name: 'UEFA Europa League', flag: 'üèÜ' },
          { name: 'UEFA Conference League', flag: 'üèÜ' },
          { name: 'Premier League', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø' },
          { name: 'LaLiga', flag: '<span class="flag-icon flag-icon-es"></span>' },
          { name: 'Bundesliga', flag: '<span class="flag-icon flag-icon-de"></span>' },
          { name: 'Serie A', flag: '<span class="flag-icon flag-icon-it"></span>' },
          { name: 'Ligue 1', flag: '<span class="flag-icon flag-icon-fr"></span>' },
          { name: 'Premijer Liga BiH', flag: '<span class="flag-icon flag-icon-ba"></span>' },
          { name: 'HNL', flag: '<span class="flag-icon flag-icon-hr"></span>' },
          { name: 'SuperLiga', flag: '<span class="flag-icon flag-icon-rs"></span>' },
          { name: 'World Cup Qualifiers', flag: 'üåç' }
        ];
      } else if (sport === 'basketball') {
        return [
          { name: 'NBA', flag: 'üèÄ' },
          { name: 'EuroLeague', flag: 'üèÜ' },
          { name: 'EuroCup', flag: 'üèÜ' },
          { name: 'ABA League', flag: 'üèÜ' }
        ];
      } else if (sport === 'tennis') {
        return [
          { name: 'ATP Tour', flag: 'üéæ' },
          { name: 'WTA Tour', flag: 'üéæ' },
          { name: 'Grand Slam', flag: 'üèÜ' },
          { name: 'Davis Cup', flag: 'üèÜ' }
        ];
      }
      return [];
    }
    
    function getCurrentPinnedLeagues() {
      return pinnedLeaguesBySport[currentSport] || [];
    }
    
    // ==================== GET INTERNATIONAL LEAGUES ====================
    function getInternationalLeagues() {
      if (currentSport === 'football') {
        return [
          { name: 'UEFA Champions League', flag: 'üèÜ' },
          { name: 'UEFA Europa League', flag: 'üèÜ' },
          { name: 'UEFA Conference League', flag: 'üèÜ' },
          { name: 'UEFA Nations League', flag: 'üèÜ' },
          { name: 'Copa Libertadores', flag: 'üèÜ' },
          { name: 'Copa Sudamericana', flag: 'üèÜ' },
          { name: 'CAF Champions League', flag: 'üèÜ' },
          { name: 'AFC Champions League', flag: 'üèÜ' },
          { name: 'CONCACAF Champions League', flag: 'üèÜ' },
          { name: 'World Cup', flag: 'üåç' },
          { category: 'Kvalifikacije za SP', items: [
            { name: 'WC Qualifiers - Europe', flag: 'üá™üá∫' },
            { name: 'WC Qualifiers - Asia', flag: 'üåè' },
            { name: 'WC Qualifiers - Africa', flag: 'üåç' },
            { name: 'WC Qualifiers - South America', flag: 'üåé' },
            { name: 'WC Qualifiers - North America', flag: 'üåé' },
            { name: 'WC Qualifiers - Oceania', flag: 'üåè' }
          ]},
          { name: 'European Championship', flag: 'üá™üá∫' },
          { name: 'Copa America', flag: 'üèÜ' },
          { name: 'Africa Cup of Nations', flag: 'üèÜ' },
          { name: 'Asian Cup', flag: 'üèÜ' }
        ];
      } else if (currentSport === 'basketball') {
        return [
          { name: 'NBA', flag: 'üèÄ' },
          { name: 'EuroLeague', flag: 'üèÜ' },
          { name: 'EuroCup', flag: 'üèÜ' },
          { name: 'ABA League', flag: 'üèÜ' },
          { name: 'Basketball Champions League', flag: 'üèÜ' },
          { name: 'FIBA World Cup', flag: 'üåç' },
          { name: 'FIBA EuroBasket', flag: 'üá™üá∫' },
          { name: 'FIBA AmeriCup', flag: 'üåé' },
          { name: 'FIBA Asia Cup', flag: 'üåè' },
          { name: 'FIBA AfroBasket', flag: 'üåç' }
        ];
      } else if (currentSport === 'tennis') {
        return [
          { name: 'ATP Tour', flag: 'üéæ' },
          { name: 'WTA Tour', flag: 'üéæ' },
          { name: 'Grand Slam', flag: 'üèÜ' },
          { name: 'Davis Cup', flag: 'üèÜ' },
          { name: 'Billie Jean King Cup', flag: 'üèÜ' },
          { name: 'ATP Finals', flag: 'üèÜ' },
          { name: 'WTA Finals', flag: 'üèÜ' }
        ];
      }
      return [];
    }
    
// ==================== GET FLAG FOR LEAGUE ====================
function getFlagForLeague(leagueName, countryName) {
  // Prvo mapiranje po imenu lige (za specijalne sluƒçajeve)
  const leagueMap = {
  // SAMO meƒëunarodne/europske lige
  'UEFA Champions League': 'eu',
  'UEFA Europa League': 'eu',
  'UEFA Conference League': 'eu',
  'UEFA Europa Conference League': 'eu',
  'UEFA Nations League': 'eu',
  'UEFA European Championship': 'eu',
  'Euro Championship': 'eu',
  'World Cup': 'un',
  'FIFA World Cup': 'un',
  'World Cup Qualification': 'un',
  'WC Qualifiers - Europe': 'eu'
};
  
  // Mapiranje dr≈æava koje API koristi drugaƒçije od ISO
  const countryExceptions = {
    'England': 'gb-eng',
    'Scotland': 'gb-sct',
    'Wales': 'gb-wls',
    'Northern-Ireland': 'gb-nir',
    'Bosnia': 'ba',
    'Bosnia-Herzegovina': 'ba',
    'Korea-Republic': 'kr',
    'Korea-DPR': 'kp',
    'Czech-Republic': 'cz',
    'USA': 'us',
    'UAE': 'ae'
  };
  
  // Prvo provjeri po imenu lige
  if (leagueMap[leagueName]) {
    return leagueMap[leagueName];
  }
  
  // Onda provjeri country exceptions
  if (countryName && countryExceptions[countryName]) {
    return countryExceptions[countryName];
  }
  
  // Automatski mapiranje - uzmi prva 2 slova i pretvori u mala
  if (countryName) {
    return countryName.toLowerCase().slice(0, 2);
  }
  
  return null;
}

// ==================== RENDER FLAG ====================
function renderFlag(countryCode) {
  if (!countryCode) return '';
  return `<span class="fi fi-${countryCode}"></span>`;
}

// ==================== RENDER FLAG ====================
function renderFlag(countryCode) {
  if (!countryCode) return '';
  return `<span class="fi fi-${countryCode}"></span>`;
}

    // ==================== COUNTRIES DATA ====================
    const COUNTRIES = [
      { id: 17, name: 'Albanija', flag: '<span class="flag-icon flag-icon-al"></span>' },
      { id: 18, name: 'Al≈æir', flag: '<span class="flag-icon flag-icon-dz"></span>' },
      { id: 19, name: 'Andora', flag: '<span class="flag-icon flag-icon-ad"></span>' },
      { id: 20, name: 'Angola', flag: '<span class="flag-icon flag-icon-ao"></span>' },
      { id: 22, name: 'Argentina', flag: '<span class="flag-icon flag-icon-ar"></span>' },
      { id: 23, name: 'Armenija', flag: '<span class="flag-icon flag-icon-am"></span>' },
      { id: 24, name: 'Australija', flag: '<span class="flag-icon flag-icon-au"></span>' },
      { id: 25, name: 'Austrija', flag: '<span class="flag-icon flag-icon-at"></span>' },
      { id: 26, name: 'Azerbejd≈æan', flag: '<span class="flag-icon flag-icon-az"></span>' },
      { id: 28, name: 'Bahrein', flag: '<span class="flag-icon flag-icon-bh"></span>' },
      { id: 29, name: 'Banglade≈°', flag: '<span class="flag-icon flag-icon-bd"></span>' },
      { id: 31, name: 'Bjelorusija', flag: '<span class="flag-icon flag-icon-by"></span>' },
      { id: 32, name: 'Belgija', flag: '<span class="flag-icon flag-icon-be"></span>' },
      { id: 37, name: 'Bosna i Hercegovina', flag: '<span class="flag-icon flag-icon-ba"></span>' },
      { id: 39, name: 'Brazil', flag: '<span class="flag-icon flag-icon-br"></span>' },
      { id: 47, name: 'Kanada', flag: '<span class="flag-icon flag-icon-ca"></span>' },
      { id: 51, name: 'ƒåile', flag: '<span class="flag-icon flag-icon-cl"></span>' },
      { id: 52, name: 'Kina', flag: '<span class="flag-icon flag-icon-cn"></span>' },
      { id: 53, name: 'Kolumbija', flag: '<span class="flag-icon flag-icon-co"></span>' },
      { id: 59, name: 'Hrvatska', flag: '<span class="flag-icon flag-icon-hr"></span>' },
      { id: 62, name: 'ƒåe≈°ka', flag: '<span class="flag-icon flag-icon-cz"></span>' },
      { id: 63, name: 'Danska', flag: '<span class="flag-icon flag-icon-dk"></span>' },
      { id: 68, name: 'Ekvador', flag: '<span class="flag-icon flag-icon-ec"></span>' },
      { id: 69, name: 'Egipat', flag: '<span class="flag-icon flag-icon-eg"></span>' },
      { id: 198, name: 'Engleska', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø' },
      { id: 76, name: 'Finska', flag: '<span class="flag-icon flag-icon-fi"></span>' },
      { id: 77, name: 'Francuska', flag: '<span class="flag-icon flag-icon-fr"></span>' },
      { id: 80, name: 'Gruzija', flag: '<span class="flag-icon flag-icon-ge"></span>' },
      { id: 81, name: 'Njemaƒçka', flag: '<span class="flag-icon flag-icon-de"></span>' },
      { id: 82, name: 'Gana', flag: '<span class="flag-icon flag-icon-gh"></span>' },
      { id: 83, name: 'Grƒçka', flag: '<span class="flag-icon flag-icon-gr"></span>' },
      { id: 91, name: 'Maƒëarska', flag: '<span class="flag-icon flag-icon-hu"></span>' },
      { id: 92, name: 'Island', flag: '<span class="flag-icon flag-icon-is"></span>' },
      { id: 93, name: 'Indija', flag: '<span class="flag-icon flag-icon-in"></span>' },
      { id: 228, name: 'Indonezija', flag: '<span class="flag-icon flag-icon-id"></span>' },
      { id: 94, name: 'Iran', flag: '<span class="flag-icon flag-icon-ir"></span>' },
      { id: 96, name: 'Irska', flag: '<span class="flag-icon flag-icon-ie"></span>' },
      { id: 97, name: 'Izrael', flag: '<span class="flag-icon flag-icon-il"></span>' },
      { id: 98, name: 'Italija', flag: '<span class="flag-icon flag-icon-it"></span>' },
      { id: 100, name: 'Japan', flag: '<span class="flag-icon flag-icon-jp"></span>' },
      { id: 101, name: 'Jordan', flag: '<span class="flag-icon flag-icon-jo"></span>' },
      { id: 102, name: 'Kazahstan', flag: '<span class="flag-icon flag-icon-kz"></span>' },
      { id: 103, name: 'Kenija', flag: '<span class="flag-icon flag-icon-ke"></span>' },
      { id: 106, name: 'Ju≈æna Koreja', flag: '<span class="flag-icon flag-icon-kr"></span>' },
      { id: 121, name: 'Malezija', flag: '<span class="flag-icon flag-icon-my"></span>' },
      { id: 128, name: 'Meksiko', flag: '<span class="flag-icon flag-icon-mx"></span>' },
      { id: 134, name: 'Maroko', flag: '<span class="flag-icon flag-icon-ma"></span>' },
      { id: 139, name: 'Nizozemska', flag: '<span class="flag-icon flag-icon-nl"></span>' },
      { id: 140, name: 'Novi Zeland', flag: '<span class="flag-icon flag-icon-nz"></span>' },
      { id: 143, name: 'Nigerija', flag: '<span class="flag-icon flag-icon-ng"></span>' },
      { id: 144, name: 'Sjeverna Irska', flag: 'üá¨üáß' },
      { id: 145, name: 'Norve≈°ka', flag: '<span class="flag-icon flag-icon-no"></span>' },
      { id: 147, name: 'Pakistan', flag: '<span class="flag-icon flag-icon-pk"></span>' },
      { id: 152, name: 'Peru', flag: '<span class="flag-icon flag-icon-pe"></span>' },
      { id: 153, name: 'Filipini', flag: '<span class="flag-icon flag-icon-ph"></span>' },
      { id: 154, name: 'Poljska', flag: '<span class="flag-icon flag-icon-pl"></span>' },
      { id: 155, name: 'Portugal', flag: '<span class="flag-icon flag-icon-pt"></span>' },
      { id: 156, name: 'Katar', flag: '<span class="flag-icon flag-icon-qa"></span>' },
      { id: 157, name: 'Rumunjska', flag: '<span class="flag-icon flag-icon-ro"></span>' },
      { id: 158, name: 'Rusija', flag: '<span class="flag-icon flag-icon-ru"></span>' },
      { id: 165, name: 'Saudijska Arabija', flag: '<span class="flag-icon flag-icon-sa"></span>' },
      { id: 199, name: '≈†kotska', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø' },
      { id: 166, name: 'Senegal', flag: '<span class="flag-icon flag-icon-sn"></span>' },
      { id: 167, name: 'Srbija', flag: '<span class="flag-icon flag-icon-rs"></span>' },
      { id: 170, name: 'Singapur', flag: '<span class="flag-icon flag-icon-sg"></span>' },
      { id: 171, name: 'Slovaƒçka', flag: '<span class="flag-icon flag-icon-sk"></span>' },
      { id: 172, name: 'Slovenija', flag: '<span class="flag-icon flag-icon-si"></span>' },
      { id: 175, name: 'Ju≈æna Afrika', flag: '<span class="flag-icon flag-icon-za"></span>' },
      { id: 176, name: '≈†panjolska', flag: '<span class="flag-icon flag-icon-es"></span>' },
      { id: 181, name: '≈†vedska', flag: '<span class="flag-icon flag-icon-se"></span>' },
      { id: 182, name: '≈†vicarska', flag: '<span class="flag-icon flag-icon-ch"></span>' },
      { id: 186, name: 'Tajland', flag: '<span class="flag-icon flag-icon-th"></span>' },
      { id: 190, name: 'Tunis', flag: '<span class="flag-icon flag-icon-tn"></span>' },
      { id: 191, name: 'Turska', flag: '<span class="flag-icon flag-icon-tr"></span>' },
      { id: 195, name: 'Ukrajina', flag: '<span class="flag-icon flag-icon-ua"></span>' },
      { id: 196, name: 'UAE', flag: '<span class="flag-icon flag-icon-ae"></span>' },
      { id: 200, name: 'SAD', flag: '<span class="flag-icon flag-icon-us"></span>' },
      { id: 201, name: 'Urugvaj', flag: '<span class="flag-icon flag-icon-uy"></span>' },
      { id: 207, name: 'Wales', flag: 'üè¥Û†ÅßÛ†Å¢Û†Å∑Û†Å¨Û†Å≥Û†Åø' }
    ];
    
    // ==================== LOAD MATCHES ====================
    async function loadMatches() {
      try {
        const response = await fetch('/api/matches');
        if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
        
        const data = await response.json();
        console.log('‚úÖ Utakmice uƒçitane:', data);
        
        allMatches = {
          football: data.football || [],
          basketball: data.basketball || [],
          tennis: data.tennis || []
        };
        
        renderSidebar();
        renderMatches();
        
      } catch (error) {
        console.error('‚ùå Gre≈°ka pri uƒçitavanju:', error);
        showError();
      }
    }

// LOAD ALL COUNTRIES
async function loadAllCountries() {
  try {
    const response = await fetch('/api/countries');
    if (!response.ok) throw new Error('Failed to load countries');
    
    const data = await response.json();
    allCountriesData = data.map(country => ({
      id: country.country_id,
      name: country.name,
      flag: getFlagForCountry(country.name)
    }));
    console.log(`‚úÖ Uƒçitano ${allCountriesData.length} dr≈æava`);
  } catch (error) {
    console.error('‚ùå Gre≈°ka:', error);
    allCountriesData = [];
  }
}

// GET FLAG FOR COUNTRY
function getFlagForCountry(countryName) {
  const countryCodeMap = {
    'England': 'gb-eng',
    'Scotland': 'gb-sct',
    'Wales': 'gb-wls',
    'Northern Ireland': 'gb-nir',
    'Bosnia and Herzegovina': 'ba',
    'USA': 'us',
    'South Korea': 'kr',
    'Czech Republic': 'cz',
    'DR Congo': 'cd',
    'United Arab Emirates': 'ae'
  };
  if (countryCodeMap[countryName]) {
    return countryCodeMap[countryName];
  }
  return countryName.toLowerCase().replace(/\s/g, '').slice(0, 2);
}


// GET FLAG FOR COUNTRY
function getFlagForCountry(countryName) {
  const countryCodeMap = {
    'Afghanistan': 'af', 'Albania': 'al', 'Algeria': 'dz', 'Andorra': 'ad',
    'Angola': 'ao', 'Antigua & Barbuda': 'ag', 'Argentina': 'ar', 'Armenia': 'am',
    'Aruba': 'aw', 'Australia': 'au', 'Austria': 'at', 'Azerbaijan': 'az',
    'Bahamas': 'bs', 'Bahrain': 'bh', 'Bangladesh': 'bd', 'Barbados': 'bb',
    'Belarus': 'by', 'Belgium': 'be', 'Belize': 'bz', 'Benin': 'bj',
    'Bermuda': 'bm', 'Bolivia': 'bo', 'Bosnia and Herzegovina': 'ba',
    'Botswana': 'bw', 'Brazil': 'br', 'Bulgaria': 'bg', 'Burkina Faso': 'bf',
    'Cambodia': 'kh', 'Cameroon': 'cm', 'Canada': 'ca', 'Cape Verde': 'cv',
    'Central African Republic': 'cf', 'Chad': 'td', 'Chile': 'cl', 'China': 'cn',
    'Colombia': 'co', 'Congo': 'cg', 'Costa Rica': 'cr', 'Croatia': 'hr',
    'Cuba': 'cu', 'Cyprus': 'cy', 'Czech Republic': 'cz', 'Denmark': 'dk',
    'Dominican Republic': 'do', 'DR Congo': 'cd', 'Ecuador': 'ec', 'Egypt': 'eg',
    'El Salvador': 'sv', 'England': 'gb-eng', 'Estonia': 'ee', 'Ethiopia': 'et',
    'Faroe Islands': 'fo', 'Finland': 'fi', 'France': 'fr', 'Georgia': 'ge',
    'Germany': 'de', 'Ghana': 'gh', 'Gibraltar': 'gi', 'Greece': 'gr',
    'Guatemala': 'gt', 'Guinea': 'gn', 'Honduras': 'hn', 'Hong Kong': 'hk',
    'Hungary': 'hu', 'Iceland': 'is', 'India': 'in', 'Indonesia': 'id',
    'Iran': 'ir', 'Iraq': 'iq', 'Ireland': 'ie', 'Israel': 'il',
    'Italy': 'it', 'Ivory Coast': 'ci', 'Jamaica': 'jm', 'Japan': 'jp',
    'Jordan': 'jo', 'Kazakhstan': 'kz', 'Kenya': 'ke', 'Kosovo': 'xk',
    'Kuwait': 'kw', 'Latvia': 'lv', 'Lebanon': 'lb', 'Lesotho': 'ls',
    'Liberia': 'lr', 'Libya': 'ly', 'Liechtenstein': 'li', 'Lithuania': 'lt',
    'Luxembourg': 'lu', 'Macao': 'mo', 'North Macedonia': 'mk', 'Malawi': 'mw',
    'Malaysia': 'my', 'Maldives': 'mv', 'Mali': 'ml', 'Malta': 'mt',
    'Martinique': 'mq', 'Mauritius': 'mu', 'Mexico': 'mx', 'Moldova': 'md',
    'Montenegro': 'me', 'Morocco': 'ma', 'Mozambique': 'mz', 'Myanmar': 'mm',
    'Namibia': 'na', 'Netherlands': 'nl', 'New Zealand': 'nz', 'Nicaragua': 'ni',
    'Nigeria': 'ng', 'Northern Ireland': 'gb-nir', 'Norway': 'no', 'Oman': 'om',
    'Pakistan': 'pk', 'Palestine': 'ps', 'Panama': 'pa', 'Paraguay': 'py',
    'Peru': 'pe', 'Philippines': 'ph', 'Poland': 'pl', 'Portugal': 'pt',
    'Qatar': 'qa', 'Republic of the Congo': 'cg', 'Romania': 'ro', 'Russia': 'ru',
    'Saudi Arabia': 'sa', 'Scotland': 'gb-sct', 'Senegal': 'sn', 'Serbia': 'rs',
    'Singapore': 'sg', 'Slovakia': 'sk', 'Slovenia': 'si', 'South Africa': 'za',
    'South Korea': 'kr', 'Spain': 'es', 'Sri Lanka': 'lk', 'Sweden': 'se',
    'Switzerland': 'ch', 'Syria': 'sy', 'Taiwan': 'tw', 'Tanzania': 'tz',
    'Thailand': 'th', 'Trinidad and Tobago': 'tt', 'Tunisia': 'tn', 'Turkey': 'tr',
    'Uganda': 'ug', 'Ukraine': 'ua', 'United Arab Emirates': 'ae', 'United Kingdom': 'gb',
    'Uruguay': 'uy', 'USA': 'us', 'Uzbekistan': 'uz', 'Venezuela': 've',
    'Vietnam': 'vn', 'Wales': 'gb-wls', 'Zambia': 'zm', 'Zimbabwe': 'zw'
  };
  
  return countryCodeMap[countryName] || 'un';
}
    
   // ==================== RENDER SIDEBAR ====================
function renderSidebar() {
  const sidebar = document.getElementById('sidebar');
  const pinnedLeagues = getCurrentPinnedLeagues();
  const visibleCountries = showAllCountries ? allCountriesData : allCountriesData.slice(0, 15);
  const internationalLeagues = getInternationalLeagues();
  
  const html = `
    <!-- PINNED LEAGUES -->
    <div class="sidebar-section">
      <div class="sidebar-title">üìå Prikovane Lige</div>
      ${
        pinnedLeagues.length > 0
          ? pinnedLeagues.map(league => {
              const isSelected =
                selectedLeague === league.name &&
                selectedCountryId === (league.countryId ?? null);
              return `
                <div class="pinned-league ${isSelected ? 'active' : ''}"
                     onclick="selectLeague('${league.name.replace(/'/g, "\\'")}', ${league.countryId ?? 'null'})">
                  <span class="league-flag">
                    ${league.flag ? `<span class="fi fi-${league.flag}"></span>` : ''}
                  </span>
                  <span>${league.name}</span>
                  <span class="pin-icon"
                        onclick="event.stopPropagation(); unpinLeague('${league.name.replace(/'/g, "\\'")}', ${league.countryId ?? 'null'}, ${league.leagueId ?? 'null'})">üìå</span>
                </div>
              `;
            }).join('')
          : '<div style="padding: 10px 20px; color: #a0aec0; font-size: 13px;">Nema prikovanih liga</div>'
      }
    </div>
    
    <!-- INTERNATIONAL LEAGUES - COLLAPSIBLE -->
    <div class="sidebar-section collapsible-section ${expandedInternational ? 'expanded' : ''}">
      <div class="collapsible-header" onclick="toggleInternational()">
        <span>üèÜ Meƒëunarodne Lige</span>
        <span class="collapsible-arrow">‚ñº</span>
      </div>
      <div class="collapsible-content">
        ${internationalLeagues.map(item => {
          if (item.category) {
            return `
              <div class="category-header">${item.category}</div>
              ${item.items.map(league => {
                const isPinned = pinnedLeagues.some(
                  p => p.name === league.name && p.countryId == null
                );
                const isSelected =
                  selectedLeague === league.name && selectedCountryId == null;
                return `
                  <div class="country-league ${isPinned ? 'pinned' : ''} ${isSelected ? 'selected' : ''}"
                       style="padding-left: 40px;"
                       onclick="selectLeague('${league.name.replace(/'/g, "\\'")}', null)">
                    <span class="league-flag">${league.flag || ''}</span>
                    <span>${league.name}</span>
                    <span class="pin-icon"
                          onclick="event.stopPropagation(); toggleInternationalLeague('${league.name.replace(/'/g, "\\'")}', '${league.flag || ''}')">
                      ${isPinned ? 'üìå' : '‚ûï'}
                    </span>
                  </div>
                `;
              }).join('')}
            `;
          } else {
            const isPinned = pinnedLeagues.some(
              p => p.name === item.name && p.countryId == null
            );
            const isSelected =
              selectedLeague === item.name && selectedCountryId == null;
            return `
              <div class="country-league ${isPinned ? 'pinned' : ''} ${isSelected ? 'selected' : ''}"
                   style="padding-left: 20px;"
                   onclick="selectLeague('${item.name.replace(/'/g, "\\'")}', null)">
                <span class="league-flag">${item.flag || ''}</span>
                <span>${item.name}</span>
                <span class="pin-icon"
                      onclick="event.stopPropagation(); toggleInternationalLeague('${item.name.replace(/'/g, "\\'")}', '${item.flag || ''}')">
                  ${isPinned ? 'üìå' : '‚ûï'}
                </span>
              </div>
            `;
          }
        }).join('')}
      </div>
    </div>
    
    <!-- COUNTRIES -->
    <div class="sidebar-section">
      <div class="sidebar-title">üåç Dr≈æave</div>
      ${visibleCountries.map(country => `
        <div class="country-item ${expandedCountries[country.id] ? 'expanded' : ''}" id="country-${country.id}">
          <div class="country-header" onclick="toggleCountry(${country.id})">
            <span class="league-flag"><span class="fi fi-${country.flag}"></span></span>
            <span>${country.name}</span>
            <span class="country-arrow">‚ñº</span>
          </div>
          <div class="country-leagues" id="leagues-${country.id}">
            ${expandedCountries[country.id] ? renderCountryLeagues(country.id) : ''}
          </div>
        </div>
      `).join('')}
      
      <div class="show-more-btn" onclick="showMoreCountries()">
        ${showAllCountries ? 'Sakrij Dr≈æave ‚ñ≤' : `Prika≈æi Sve Dr≈æave (${allCountriesData.length}) ‚ñº`}
      </div>
    </div>
  `;

  sidebar.innerHTML = html;
}

// ==================== SELECT LEAGUE ====================
function selectLeague(leagueName, countryId = null) {
  selectedLeague = leagueName;
  selectedCountryId = countryId ?? null;
  renderSidebar();
}

// ==================== TOGGLE INTERNATIONAL ====================
function toggleInternational() {
  expandedInternational = !expandedInternational;
  renderSidebar();
}

// ==================== TOGGLE COUNTRY ====================
async function toggleCountry(countryId) {
  expandedCountries[countryId] = !expandedCountries[countryId];
  
  if (expandedCountries[countryId] && !countryLeagues[`${currentSport}-${countryId}`]) {
    await loadCountryLeagues(countryId);
  }
  
  renderSidebar();
}

// ==================== LOAD COUNTRY LEAGUES ====================
async function loadCountryLeagues(countryId) {
  try {
    const sportId = currentSport === 'football' ? 1 : currentSport === 'basketball' ? 3 : 2;
    const response = await fetch(`/api/leagues?sport=${sportId}&country=${countryId}`);
    
    if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
    
    const data = await response.json();
    countryLeagues[`${currentSport}-${countryId}`] = data.leagues || [];
    console.log(
  `‚úÖ Uƒçitano ${countryLeagues[`${currentSport}-${countryId}`].length} liga za ${currentSport}, dr≈æava ${countryId}`
);

    
  } catch (error) {
    console.error(`‚ùå Gre≈°ka pri uƒçitavanju liga za dr≈æavu ${countryId}:`, error);
    countryLeagues[`${currentSport}-${countryId}`] = [];
  }
}

// ==================== RENDER COUNTRY LEAGUES ====================
function renderCountryLeagues(countryId) {
  const leagues = countryLeagues[`${currentSport}-${countryId}`] || [];
  const pinnedLeagues = getCurrentPinnedLeagues();
  const country = COUNTRIES.find(c => c.id == countryId);
  
  if (leagues.length === 0) {
    return '<div class="country-league">Uƒçitavanje...</div>';
  }
  
  return leagues.map(league => {
    const isPinned = pinnedLeagues.some(
      p => p.name === league.name && p.countryId === countryId
    );
    const isSelected =
      selectedLeague === league.name && selectedCountryId === countryId;

    const flag = country?.flag || getFlagForLeague(league.name, country?.name || null);

    return `
      <div class="country-league ${isPinned ? 'pinned' : ''} ${isSelected ? 'selected' : ''}"
           onclick="selectLeague('${league.name.replace(/'/g, "\\'")}', ${countryId})">
        <span class="league-flag">${flag ? `<span class="fi fi-${flag}"></span>` : 'üèÜ'}</span>
        <span>${league.name}</span>
        <span class="pin-icon"
              onclick="event.stopPropagation(); togglePinLeague('${league.name.replace(/'/g, "\\'")}', ${countryId}, ${league.id || 'null'})">
          ${isPinned ? 'üìå' : '‚ûï'}
        </span>
      </div>
    `;
  }).join('');
}

// ==================== PIN/UNPIN LEAGUE ====================
function togglePinLeague(leagueName, countryId = null, leagueId = null) {
  const pinnedLeagues = getCurrentPinnedLeagues();
  const key = {
    name: leagueName,
    countryId: countryId ?? null,
    leagueId: leagueId ?? null
  };

  const isPinned = pinnedLeagues.some(
    p => p.name === key.name && p.countryId === key.countryId && p.leagueId === key.leagueId
  );

  if (isPinned) {
    unpinLeague(leagueName, countryId, leagueId);
  } else {
    const country = countryId ? COUNTRIES.find(c => c.id == countryId) : null;
    const flag = country?.flag || getFlagForLeague(leagueName, country?.name || null);

    pinnedLeagues.push({
      name: key.name,
      countryId: key.countryId,
      leagueId: key.leagueId,
      flag: flag || null
    });

    pinnedLeaguesBySport[currentSport] = pinnedLeagues;
    localStorage.setItem('pinnedLeaguesBySport', JSON.stringify(pinnedLeaguesBySport));
    renderSidebar();
    renderMatches();
  }
}

function unpinLeague(leagueName, countryId = null, leagueId = null) {
  const pinnedLeagues = getCurrentPinnedLeagues();
  const key = {
    name: leagueName,
    countryId: countryId ?? null,
    leagueId: leagueId ?? null
  };

  pinnedLeaguesBySport[currentSport] = pinnedLeagues.filter(
    p => !(p.name === key.name && p.countryId === key.countryId && p.leagueId === key.leagueId)
  );

  localStorage.setItem('pinnedLeaguesBySport', JSON.stringify(pinnedLeaguesBySport));
  renderSidebar();
  renderMatches();
}

// ==================== TOGGLE INTERNATIONAL LEAGUE ====================
function toggleInternationalLeague(leagueName, flag) {
  const pinnedLeagues = getCurrentPinnedLeagues();
  const isPinned = pinnedLeagues.some(
    p => p.name === leagueName && p.countryId == null
  );
  
  if (isPinned) {
    unpinLeague(leagueName, null, null);
  } else {
    pinnedLeagues.push({
      name: leagueName,
      countryId: null,
      leagueId: null,
      flag: flag || null
    });
    pinnedLeaguesBySport[currentSport] = pinnedLeagues;
    localStorage.setItem('pinnedLeaguesBySport', JSON.stringify(pinnedLeaguesBySport));
    renderSidebar();
    renderMatches();
  }
}

// ==================== SHOW MORE COUNTRIES ====================
function showMoreCountries() {
  showAllCountries = !showAllCountries;
  renderSidebar();
}

// ==================== RENDER MATCHES ====================
function renderMatches() {
  const content = document.getElementById('content');
  let matches = allMatches[currentSport];
  const pinnedLeagues = getCurrentPinnedLeagues();
  const pinnedLeagueNames = pinnedLeagues.map(l => l.name);
  
  if (!matches || matches.length === 0) {
    content.innerHTML = `
      <div class="no-matches">
        <h2>Nema dostupnih utakmica</h2>
        <p>Provjerite kasnije za ${currentSport === 'football' ? 'nogometne' : currentSport === 'basketball' ? 'ko≈°arka≈°ke' : 'teniske'} utakmice!</p>
      </div>
    `;
    return;
  }
  
 if (pinnedLeagues.length > 0) {
  matches = matches.filter(match => {
    if (!match.tournament_name) return false;

    return pinnedLeagues.some(p => {
      // posebna logika za englesku Premier League
      if (p.name === 'Premier League') {
        return match.tournament_name === 'ENGLAND: Premier League';
      }
      // ostale lige kao do sada
      return match.tournament_name.includes(p.name);
    });
   });
  }

  
  if (matches.length === 0) {
    content.innerHTML = `
      <div class="no-matches">
        <h2>Nema utakmica iz prikovanih liga</h2>
        <p>Prikovajte neke lige iz sidebar-–∞ da vidite utakmice!</p>
      </div>
    `;
    return;
  }
  
  const grouped = {};
  matches.forEach(match => {
    const leagueName = match.tournament_name || 'Nepoznata Liga';
    if (!grouped[leagueName]) {
      grouped[leagueName] = {
        name: leagueName,
        country: match.country_name || '',
        matches: []
      };
    }
    grouped[leagueName].matches.push(match);
  });
  
  const leagues = Object.values(grouped).sort((a, b) => {
    const aIndex = pinnedLeagueNames.findIndex(name => a.name.includes(name));
    const bIndex = pinnedLeagueNames.findIndex(name => b.name.includes(name));
    
    if (aIndex !== -1 && bIndex !== -1) return aIndex - bIndex;
    if (aIndex !== -1) return -1;
    if (bIndex !== -1) return 1;
    return a.name.localeCompare(b.name);
  });
  
  const html = leagues.map(league => {
    return `
      <div class="league-section">
        <div class="league-header">
          ${renderFlag(getFlagForLeague(league.name, league.country || null))}
          <span class="league-country">${league.country}</span>
          ${league.name}
        </div>
        ${league.matches.map(match => createMatchCard(match)).join('')}
      </div>
    `;
  }).join('');
  
  content.innerHTML = html;
}

    
    // ==================== CREATE MATCH CARD ====================
    function createMatchCard(match) {
      const homeTeam = match.home_team?.name || 'Domaƒáin';
      const awayTeam = match.away_team?.name || 'Gost';
      const homeScore = match.home_team?.score ?? '-';
      const awayScore = match.away_team?.score ?? '-';
      const homeLogo = match.home_team?.image_path || '';
      const awayLogo = match.away_team?.image_path || '';
      
      let status = '';
      let statusClass = '';
      
      if (match.stage) {
        const stage = match.stage.toString();
        if (!isNaN(stage) && stage !== '0') {
          status = stage + "'";
          statusClass = 'live';
        } else if (stage === 'Finished') {
          status = 'FT';
        } else if (stage === 'Half Time' || stage === 'HT') {
          status = 'HT';
          statusClass = 'live';
        } else if (match.timestamp) {
          const matchDate = new Date(match.timestamp * 1000);
          status = matchDate.toLocaleTimeString('hr-HR', { hour: '2-digit', minute: '2-digit' });
        } else {
          status = stage;
        }
      } else if (match.timestamp) {
        const matchDate = new Date(match.timestamp * 1000);
        status = matchDate.toLocaleTimeString('hr-HR', { hour: '2-digit', minute: '2-digit' });
      }
      
      return `
        <div class="match-card">
          <div class="match-header">
            <div class="match-time ${statusClass}">${status}</div>
          </div>
          <div class="match-teams">
            <div class="team">
              ${homeLogo ? `<img src="${homeLogo}" class="team-logo" alt="${homeTeam}">` : ''}
              <div class="team-name">${homeTeam}</div>
              <div class="team-score">${homeScore}</div>
            </div>
            <div class="match-vs">-</div>
            <div class="team team-right">
              <div class="team-score">${awayScore}</div>
              <div class="team-name">${awayTeam}</div>
              ${awayLogo ? `<img src="${awayLogo}" class="team-logo" alt="${awayTeam}">` : ''}
            </div>
          </div>
        </div>
      `;
    }
    
    // ==================== SHOW ERROR ====================
    function showError() {
      document.getElementById('content').innerHTML = `
        <div class="no-matches">
          <h2>Gre≈°ka pri uƒçitavanju utakmica</h2>
          <p>Molimo osvje≈æite stranicu ili poku≈°ajte kasnije.</p>
        </div>
      `;
    }
    
    // ==================== SPORT TAB CLICK ====================
    document.querySelectorAll('.sport-tab').forEach(tab => {
      tab.addEventListener('click', () => {
        document.querySelectorAll('.sport-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentSport = tab.dataset.sport;
        expandedCountries = {};
        expandedInternational = false;
        showAllCountries = false;
        selectedLeague = null;
        renderSidebar();
        renderMatches();
      });
    });
    
    // ==================== INIT ====================
    async function init() {
  await loadAllCountries();
  await loadMatches();
  renderSidebar();
}

init();
setInterval(loadMatches, 180000);
  </script>

</body>
</html>
